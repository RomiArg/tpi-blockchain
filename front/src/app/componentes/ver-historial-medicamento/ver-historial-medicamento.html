<h1 mat-dialog-title class="color-consulta">Trazabilidad del Activo: {{ data.assetID }}</h1>

<mat-dialog-content>
    <mat-card class="info-card">
        <mat-card-header>
            <mat-card-title>{{ data.nombreComercial }}</mat-card-title>
            <mat-card-subtitle>Lote: {{ data.lote }}</mat-card-subtitle>
        </mat-card-header>
    </mat-card>

    <h3>Historial de Transacciones</h3>

    @if (cargando) {
    <div class="spinner-container">
        <mat-spinner [diameter]="40"></mat-spinner>
    </div>
    }

    <mat-list>
        @for (item of (historial | async); track item.txId) {
            <mat-card>
                <br>
                <mat-list-item class="history-item">
                    <mat-icon matListItemIcon>check_circle</mat-icon>
                    <div matListItemTitle class="tx-id">TX-ID: <span class="selectable">{{ item.txId }}</span></div>
                    <div matListItemLine>
                        <span><strong>Estado:</strong> {{ estadoNombre(item.medicamento.estadoActual) }}</span>
                    </div>
                    <div matListItemLine>
                        <span><strong>Propietario:</strong> {{ getPropietarioNombre(item.medicamento.propietarioActualID) }}</span>
                    </div>
                    <div matListItemLine>
                        <span><strong>Fecha:</strong> {{ item.timestamp | date:'dd/MM/yyyy HH:mm:ss' }}</span>
                    </div>
                </mat-list-item>
                <br>
            </mat-card>
            <br>
        }
    </mat-list>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-raised-button color="primary" (click)="onClose()">Cerrar</button>
</mat-dialog-actions>